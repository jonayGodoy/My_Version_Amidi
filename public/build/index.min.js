/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;
/******/
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// identity function for calling harmony imports with the correct context
/******/ 	__webpack_require__.i = function(value) { return value; };
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 5);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var ManagerFile = __webpack_require__(2);
var ManagerGame = __webpack_require__(3);
var ManagerQuiz = __webpack_require__(4);
var ManagerDom = __webpack_require__(1);

initialise();
function initialise() {
    var managerFile = new ManagerFile();
    var listJson = managerFile.loadJson();
    var managerQuiz = new ManagerQuiz(listJson.preguntas);
    var managerDom = new ManagerDom();
    var numberForWin = 5;
    var managerGame = new ManagerGame(managerQuiz, managerDom, numberForWin);

    window.start = managerGame.startGame;
    window.updateAnswer = managerGame.updateAnswer;
    window.nextQuestion = managerGame.nextQuestion;
}

/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function ManagerDom() {
    var _this = this;

    var idLoad = "amidi";
    var idApp = "app";

    var idQuestion = "preguntas";
    var idNext = "siguiente";

    var idWin = "ganador";

    this.start = function () {
        var divLoad = document.getElementById(idLoad);
        var divApp = document.getElementById(idApp);

        divLoad.classList.add('hidden');
        divApp.classList.remove('hidden');

        document.body.style.backgroundColor = '#57CCD8';
    };

    this.renderQuestion = function (question) {
        var divQuestion = document.getElementById(idQuestion);

        var answerHtml = "<h1 class='center'>" + question.pregunta + "</h1>";
        for (var nAnswer in question.respuestas) {
            answerHtml = answerHtml + " <div class=\"pregunta\"" + " id=\"" + question.respuestas[nAnswer] + "\"" + " onclick=\"window.updateAnswer('" + question.respuestas[nAnswer] + "')\">" + question.respuestas[nAnswer] + "</div>";
        }
        divQuestion.innerHTML = answerHtml;
    };

    this.renderQuestionAnswered = function (answer, isCorrect) {
        var divAnswer = document.getElementById(answer);
        removeAnswerOnClick();

        isCorrect ? divAnswer.style.color = 'yellowgreen' : divAnswer.style.color = 'red';
    };

    this.toggleButtonNext = function () {
        var classList = document.getElementById(idNext).classList;
        var isHidden = classList.contains('hidden');

        isHidden ? classList.remove('hidden') : classList.add('hidden');
    };

    this.printVictory = function () {
        var divVictory = document.getElementById(idWin);
        var divQuestion = document.getElementById(idQuestion);

        _this.toggleButtonNext();
        divVictory.classList.remove('hidden');

        divQuestion.classList.add('hidden');
    };

    function removeAnswerOnClick() {
        var divQuestion = document.getElementById(idQuestion);

        var childNodes = divQuestion.childNodes;
        for (var i = 0; i < childNodes.length; i++) {
            childNodes[i].onclick = function () {
                return false;
            };
        }
    }
};

/***/ }),
/* 2 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function ManagerFile() {
    this.loadJson = function () {
        var httpRequest = new XMLHttpRequest();
        httpRequest.onreadystatechange = function () {
            if (httpRequest.readyState === 4) {
                if (httpRequest.status === 200) {
                    var data = httpRequest.responseText;
                    localStorage.setItem('preguntas', data);
                }
            }
        };
        httpRequest.open('get', '../public/preguntas.json');
        httpRequest.send();
        return JSON.parse(localStorage.getItem("preguntas"));
    };
};

/***/ }),
/* 3 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function ManagerGame(managerQuiz, managerDom, numberForWin) {

    var NUMBER_FOR_WIN = numberForWin;

    var countQuestionsSuccess = 0;

    constructor();
    function constructor() {
        if (NUMBER_FOR_WIN == undefined) throw "You have introduce numberForWin in the constructor";
        if (!Number.isInteger(NUMBER_FOR_WIN)) throw "You numberForWin have type Integer";
    }

    this.startGame = function () {
        managerDom.start();

        var question = managerQuiz.getCurrentQuestion();
        managerDom.renderQuestion(question);
    };

    this.updateAnswer = function (answer) {
        var isCorrect = managerQuiz.isCorrectQuestion(answer);
        if (isCorrect) {
            countQuestionsSuccess = countQuestionsSuccess + 1;
            managerQuiz.updateQuestions();
        }

        managerDom.renderQuestionAnswered(answer, isCorrect);
        managerDom.toggleButtonNext();
    };

    this.nextQuestion = function () {
        if (isPlayerWin()) {
            managerDom.printVictory();
        } else {
            var question = managerQuiz.getCurrentQuestion();
            managerDom.renderQuestion(question);
            managerDom.toggleButtonNext();
        }
    };

    function isPlayerWin() {
        return countQuestionsSuccess === NUMBER_FOR_WIN;
    };
};

/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function ManagerQuiz(ListQuestion) {

    var listQuestion = ListQuestion;
    var currentQuestion = randomQuestion();

    this.getCurrentQuestion = function () {
        return currentQuestion;
    };

    this.getListQuestion = function () {
        return listQuestion;
    };

    this.isCorrectQuestion = function (answer) {
        var result = currentQuestion.respuesta === answer;
        return result;
    };

    this.updateQuestions = function () {
        deleteCurrentQuestionToList();
        currentQuestion = randomQuestion();
    };

    function randomQuestion() {
        var index = Math.floor(Math.random() * (listQuestion.length - 0) + 0);
        return listQuestion[index];
    }

    function deleteCurrentQuestionToList() {
        var position = listQuestion.indexOf(currentQuestion);
        listQuestion.splice(position, 1);
    }
};

/***/ }),
/* 5 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(0);


/***/ })
/******/ ]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgYjI3NDI1NTIxMDY1ZWZkMGNjYWQiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9NYW5hZ2VyRG9tLmpzIiwid2VicGFjazovLy8uL3NyYy9NYW5hZ2VyRmlsZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvTWFuYWdlckdhbWUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL01hbmFnZXJRdWl6LmpzIl0sIm5hbWVzIjpbIk1hbmFnZXJGaWxlIiwicmVxdWlyZSIsIk1hbmFnZXJHYW1lIiwiTWFuYWdlclF1aXoiLCJNYW5hZ2VyRG9tIiwiaW5pdGlhbGlzZSIsIm1hbmFnZXJGaWxlIiwibGlzdEpzb24iLCJsb2FkSnNvbiIsIm1hbmFnZXJRdWl6IiwicHJlZ3VudGFzIiwibWFuYWdlckRvbSIsIm51bWJlckZvcldpbiIsIm1hbmFnZXJHYW1lIiwid2luZG93Iiwic3RhcnQiLCJzdGFydEdhbWUiLCJ1cGRhdGVBbnN3ZXIiLCJuZXh0UXVlc3Rpb24iLCJtb2R1bGUiLCJleHBvcnRzIiwiaWRMb2FkIiwiaWRBcHAiLCJpZFF1ZXN0aW9uIiwiaWROZXh0IiwiaWRXaW4iLCJkaXZMb2FkIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImRpdkFwcCIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsImJvZHkiLCJzdHlsZSIsImJhY2tncm91bmRDb2xvciIsInJlbmRlclF1ZXN0aW9uIiwicXVlc3Rpb24iLCJkaXZRdWVzdGlvbiIsImFuc3dlckh0bWwiLCJwcmVndW50YSIsIm5BbnN3ZXIiLCJyZXNwdWVzdGFzIiwiaW5uZXJIVE1MIiwicmVuZGVyUXVlc3Rpb25BbnN3ZXJlZCIsImFuc3dlciIsImlzQ29ycmVjdCIsImRpdkFuc3dlciIsInJlbW92ZUFuc3dlck9uQ2xpY2siLCJjb2xvciIsInRvZ2dsZUJ1dHRvbk5leHQiLCJpc0hpZGRlbiIsImNvbnRhaW5zIiwicHJpbnRWaWN0b3J5IiwiZGl2VmljdG9yeSIsImNoaWxkTm9kZXMiLCJpIiwibGVuZ3RoIiwib25jbGljayIsImh0dHBSZXF1ZXN0IiwiWE1MSHR0cFJlcXVlc3QiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJyZWFkeVN0YXRlIiwic3RhdHVzIiwiZGF0YSIsInJlc3BvbnNlVGV4dCIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJvcGVuIiwic2VuZCIsIkpTT04iLCJwYXJzZSIsImdldEl0ZW0iLCJOVU1CRVJfRk9SX1dJTiIsImNvdW50UXVlc3Rpb25zU3VjY2VzcyIsImNvbnN0cnVjdG9yIiwidW5kZWZpbmVkIiwiTnVtYmVyIiwiaXNJbnRlZ2VyIiwiZ2V0Q3VycmVudFF1ZXN0aW9uIiwiaXNDb3JyZWN0UXVlc3Rpb24iLCJ1cGRhdGVRdWVzdGlvbnMiLCJpc1BsYXllcldpbiIsIkxpc3RRdWVzdGlvbiIsImxpc3RRdWVzdGlvbiIsImN1cnJlbnRRdWVzdGlvbiIsInJhbmRvbVF1ZXN0aW9uIiwiZ2V0TGlzdFF1ZXN0aW9uIiwicmVzdWx0IiwicmVzcHVlc3RhIiwiZGVsZXRlQ3VycmVudFF1ZXN0aW9uVG9MaXN0IiwiaW5kZXgiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJwb3NpdGlvbiIsImluZGV4T2YiLCJzcGxpY2UiXSwibWFwcGluZ3MiOiI7QUFBQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOzs7QUFHQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxtREFBMkMsY0FBYzs7QUFFekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBMkIsMEJBQTBCLEVBQUU7QUFDdkQseUNBQWlDLGVBQWU7QUFDaEQ7QUFDQTtBQUNBOztBQUVBO0FBQ0EsOERBQXNELCtEQUErRDs7QUFF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O0FBQ0ExQix1QkFBV3VDLGdCQUFYO0FBQ0g7QUFFSixLQVREOztBQVdBLGFBQVNnQyxXQUFULEdBQXNCO0FBQ2xCLGVBQVFSLDBCQUEwQkQsY0FBbEM7QUFDSDtBQUVKLENBL0NELEM7Ozs7Ozs7QUNGQTs7QUFFQXRELE9BQU9DLE9BQVAsR0FBaUIsU0FBU2pCLFdBQVQsQ0FBcUJnRixZQUFyQixFQUFtQzs7QUFFaEQsUUFBSUMsZUFBZUQsWUFBbkI7QUFDQSxRQUFJRSxrQkFBa0JDLGdCQUF0Qjs7QUFHQSxTQUFLUCxrQkFBTCxHQUEwQjtBQUFBLGVBQU9NLGVBQVA7QUFBQSxLQUExQjs7QUFFQSxTQUFLRSxlQUFMLEdBQXVCO0FBQUEsZUFBT0gsWUFBUDtBQUFBLEtBQXZCOztBQUdDLFNBQUtKLGlCQUFMLEdBQXlCLFVBQVNuQyxNQUFULEVBQWlCO0FBQ3ZDLFlBQUkyQyxTQUFTSCxnQkFBZ0JJLFNBQWhCLEtBQThCNUMsTUFBM0M7QUFDQyxlQUFPMkMsTUFBUDtBQUNKLEtBSEE7O0FBS0QsU0FBS1AsZUFBTCxHQUF3QixZQUFXO0FBQy9CUztBQUNBTCwwQkFBa0JDLGdCQUFsQjtBQUNILEtBSEQ7O0FBS0EsYUFBU0EsY0FBVCxHQUEwQjtBQUN0QixZQUFJSyxRQUFRQyxLQUFLQyxLQUFMLENBQVdELEtBQUtFLE1BQUwsTUFBaUJWLGFBQWEzQixNQUFiLEdBQXNCLENBQXZDLElBQTRDLENBQXZELENBQVo7QUFDQSxlQUFPMkIsYUFBYU8sS0FBYixDQUFQO0FBQ0g7O0FBRUQsYUFBU0QsMkJBQVQsR0FBc0M7QUFDbEMsWUFBSUssV0FBV1gsYUFBYVksT0FBYixDQUFxQlgsZUFBckIsQ0FBZjtBQUNBRCxxQkFBYWEsTUFBYixDQUFvQkYsUUFBcEIsRUFBNkIsQ0FBN0I7QUFDSDtBQUVKLENBL0JELEMiLCJmaWxlIjoiaW5kZXgubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG5cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGlkZW50aXR5IGZ1bmN0aW9uIGZvciBjYWxsaW5nIGhhcm1vbnkgaW1wb3J0cyB3aXRoIHRoZSBjb3JyZWN0IGNvbnRleHRcbiBcdF9fd2VicGFja19yZXF1aXJlX18uaSA9IGZ1bmN0aW9uKHZhbHVlKSB7IHJldHVybiB2YWx1ZTsgfTtcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbiBcdFx0XHRcdGdldDogZ2V0dGVyXG4gXHRcdFx0fSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gNSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd2VicGFjay9ib290c3RyYXAgYjI3NDI1NTIxMDY1ZWZkMGNjYWQiLCIndXNlIHN0cmljdCc7XHJcblxyXG5sZXQgTWFuYWdlckZpbGUgPSByZXF1aXJlKCcuL01hbmFnZXJGaWxlJyk7XHJcbmxldCBNYW5hZ2VyR2FtZSA9IHJlcXVpcmUoJy4vTWFuYWdlckdhbWUnKTtcclxubGV0IE1hbmFnZXJRdWl6ID0gcmVxdWlyZSgnLi9NYW5hZ2VyUXVpeicpO1xyXG5sZXQgTWFuYWdlckRvbSA9IHJlcXVpcmUoJy4vTWFuYWdlckRvbScpO1xyXG5cclxuaW5pdGlhbGlzZSgpO1xyXG5mdW5jdGlvbiBpbml0aWFsaXNlKCl7XHJcbiAgICBsZXQgbWFuYWdlckZpbGUgPSBuZXcgTWFuYWdlckZpbGUoKTtcclxuICAgIGxldCBsaXN0SnNvbiA9IG1hbmFnZXJGaWxlLmxvYWRKc29uKCk7XHJcbiAgICBsZXQgbWFuYWdlclF1aXogPSBuZXcgTWFuYWdlclF1aXoobGlzdEpzb24ucHJlZ3VudGFzKTtcclxuICAgIGxldCBtYW5hZ2VyRG9tID0gbmV3IE1hbmFnZXJEb20oKTtcclxuICAgIGxldCBudW1iZXJGb3JXaW4gPSA1O1xyXG4gICAgbGV0IG1hbmFnZXJHYW1lID0gbmV3IE1hbmFnZXJHYW1lKG1hbmFnZXJRdWl6LG1hbmFnZXJEb20sbnVtYmVyRm9yV2luKTtcclxuXHJcbiAgICB3aW5kb3cuc3RhcnQgPSBtYW5hZ2VyR2FtZS5zdGFydEdhbWU7XHJcbiAgICB3aW5kb3cudXBkYXRlQW5zd2VyID0gbWFuYWdlckdhbWUudXBkYXRlQW5zd2VyO1xyXG4gICAgd2luZG93Lm5leHRRdWVzdGlvbiA9IG1hbmFnZXJHYW1lLm5leHRRdWVzdGlvbjtcclxufVxyXG5cclxuXHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9pbmRleC5qcyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gTWFuYWdlckRvbSgpIHtcclxuXHJcbiAgICBjb25zdCBpZExvYWQgPSBcImFtaWRpXCI7XHJcbiAgICBjb25zdCBpZEFwcCA9IFwiYXBwXCI7XHJcblxyXG4gICAgY29uc3QgaWRRdWVzdGlvbiA9IFwicHJlZ3VudGFzXCI7XHJcbiAgICBjb25zdCBpZE5leHQgPSBcInNpZ3VpZW50ZVwiO1xyXG5cclxuICAgIGNvbnN0IGlkV2luID0gXCJnYW5hZG9yXCI7XHJcblxyXG4gICAgdGhpcy5zdGFydCA9ICgpID0+IHtcclxuICAgICAgICBsZXQgZGl2TG9hZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkTG9hZCk7XHJcbiAgICAgICAgbGV0IGRpdkFwcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkQXBwKTtcclxuXHJcbiAgICAgICAgZGl2TG9hZC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcclxuICAgICAgICBkaXZBcHAuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XHJcblxyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyM1N0NDRDgnO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLnJlbmRlclF1ZXN0aW9uID0gKHF1ZXN0aW9uKSA9PiB7XHJcbiAgICAgICAgbGV0IGRpdlF1ZXN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWRRdWVzdGlvbik7XHJcblxyXG4gICAgICAgIGxldCBhbnN3ZXJIdG1sID0gXCI8aDEgY2xhc3M9J2NlbnRlcic+XCIrcXVlc3Rpb24ucHJlZ3VudGErXCI8L2gxPlwiO1xyXG4gICAgICAgIGZvcihsZXQgbkFuc3dlciBpbiBxdWVzdGlvbi5yZXNwdWVzdGFzKXtcclxuICAgICAgICAgICAgYW5zd2VySHRtbCA9IGFuc3dlckh0bWwgK1xyXG4gICAgICAgICAgICAgICAgYCA8ZGl2IGNsYXNzPVwicHJlZ3VudGFcImBcclxuICAgICAgICAgICAgICAgICtgIGlkPVwiYCtxdWVzdGlvbi5yZXNwdWVzdGFzW25BbnN3ZXJdK2BcImBcclxuICAgICAgICAgICAgICAgICtgIG9uY2xpY2s9XCJ3aW5kb3cudXBkYXRlQW5zd2VyKCdgK3F1ZXN0aW9uLnJlc3B1ZXN0YXNbbkFuc3dlcl0rYCcpXCI+YFxyXG4gICAgICAgICAgICAgICAgKyBxdWVzdGlvbi5yZXNwdWVzdGFzW25BbnN3ZXJdXHJcbiAgICAgICAgICAgICAgICArIGA8L2Rpdj5gO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkaXZRdWVzdGlvbi5pbm5lckhUTUwgPSBhbnN3ZXJIdG1sO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLnJlbmRlclF1ZXN0aW9uQW5zd2VyZWQgPSAoYW5zd2VyLCBpc0NvcnJlY3QpID0+IHtcclxuICAgICAgICBsZXQgZGl2QW5zd2VyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYW5zd2VyKTtcclxuICAgICAgICByZW1vdmVBbnN3ZXJPbkNsaWNrKCk7XHJcblxyXG4gICAgICAgIGlzQ29ycmVjdCA/XHJcbiAgICAgICAgICAgIGRpdkFuc3dlci5zdHlsZS5jb2xvciA9ICd5ZWxsb3dncmVlbidcclxuICAgICAgICAgICAgOiBkaXZBbnN3ZXIuc3R5bGUuY29sb3IgPSAncmVkJztcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy50b2dnbGVCdXR0b25OZXh0ID0gKCkgPT4ge1xyXG4gICAgICAgIGxldCBjbGFzc0xpc3QgPSAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWROZXh0KS5jbGFzc0xpc3Q7XHJcbiAgICAgICAgbGV0IGlzSGlkZGVuID0gIGNsYXNzTGlzdC5jb250YWlucygnaGlkZGVuJyk7XHJcblxyXG4gICAgICAgIGlzSGlkZGVuID9cclxuICAgICAgICAgICAgY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJylcclxuICAgICAgICAgICAgOiBjbGFzc0xpc3QuYWRkKCdoaWRkZW4nKVxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLnByaW50VmljdG9yeSA9ICgpID0+IHtcclxuICAgICAgICBsZXQgZGl2VmljdG9yeSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkV2luKTtcclxuICAgICAgICBsZXQgZGl2UXVlc3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZFF1ZXN0aW9uKTtcclxuXHJcblxyXG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uTmV4dCgpO1xyXG4gICAgICAgIGRpdlZpY3RvcnkuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XHJcblxyXG4gICAgICAgIGRpdlF1ZXN0aW9uLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xyXG4gICAgfTtcclxuXHJcbiAgICBmdW5jdGlvbiByZW1vdmVBbnN3ZXJPbkNsaWNrKCl7XHJcbiAgICAgICAgbGV0IGRpdlF1ZXN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWRRdWVzdGlvbik7XHJcblxyXG4gICAgICAgIGxldCBjaGlsZE5vZGVzID0gZGl2UXVlc3Rpb24uY2hpbGROb2RlcztcclxuICAgICAgICBmb3IoIGxldCBpID0wO2kgPCBjaGlsZE5vZGVzLmxlbmd0aDtpKyspe1xyXG4gICAgICAgICAgICBjaGlsZE5vZGVzW2ldLm9uY2xpY2sgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG59O1xyXG5cclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL01hbmFnZXJEb20uanMiLCIndXNlIHN0cmljdCc7XHJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gTWFuYWdlckZpbGUoKSB7XHJcbiAgICAgdGhpcy5sb2FkSnNvbiA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgbGV0IGh0dHBSZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbiAgICAgICAgaHR0cFJlcXVlc3Qub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmIChodHRwUmVxdWVzdC5yZWFkeVN0YXRlID09PSA0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaHR0cFJlcXVlc3Quc3RhdHVzID09PSAyMDApIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IGh0dHBSZXF1ZXN0LnJlc3BvbnNlVGV4dDtcclxuICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncHJlZ3VudGFzJyxkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaHR0cFJlcXVlc3Qub3BlbignZ2V0JywgJy4uL3B1YmxpYy9wcmVndW50YXMuanNvbicpO1xyXG4gICAgICAgIGh0dHBSZXF1ZXN0LnNlbmQoKTtcclxuICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJwcmVndW50YXNcIikpO1xyXG4gICAgfVxyXG59O1xyXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvTWFuYWdlckZpbGUuanMiLCIndXNlIHN0cmljdCc7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIE1hbmFnZXJHYW1lKG1hbmFnZXJRdWl6LCBtYW5hZ2VyRG9tLCBudW1iZXJGb3JXaW4pIHtcclxuXHJcbiAgICBjb25zdCBOVU1CRVJfRk9SX1dJTiA9IG51bWJlckZvcldpbjtcclxuXHJcbiAgICBsZXQgY291bnRRdWVzdGlvbnNTdWNjZXNzID0gMDtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpO1xyXG4gICAgZnVuY3Rpb24gY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgaWYoTlVNQkVSX0ZPUl9XSU4gPT0gdW5kZWZpbmVkKVxyXG4gICAgICAgICAgICB0aHJvdyBcIllvdSBoYXZlIGludHJvZHVjZSBudW1iZXJGb3JXaW4gaW4gdGhlIGNvbnN0cnVjdG9yXCI7XHJcbiAgICAgICAgaWYoIU51bWJlci5pc0ludGVnZXIoTlVNQkVSX0ZPUl9XSU4pKVxyXG4gICAgICAgICAgICB0aHJvdyBcIllvdSBudW1iZXJGb3JXaW4gaGF2ZSB0eXBlIEludGVnZXJcIjtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLnN0YXJ0R2FtZSA9ICgpID0+IHtcclxuICAgICAgICBtYW5hZ2VyRG9tLnN0YXJ0KCk7XHJcblxyXG4gICAgICAgIGxldCBxdWVzdGlvbiA9IG1hbmFnZXJRdWl6LmdldEN1cnJlbnRRdWVzdGlvbigpO1xyXG4gICAgICAgIG1hbmFnZXJEb20ucmVuZGVyUXVlc3Rpb24ocXVlc3Rpb24pO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLnVwZGF0ZUFuc3dlciA9IChhbnN3ZXIpID0+IHtcclxuICAgICAgICBsZXQgaXNDb3JyZWN0ID0gbWFuYWdlclF1aXouaXNDb3JyZWN0UXVlc3Rpb24oYW5zd2VyKVxyXG4gICAgICAgIGlmKGlzQ29ycmVjdCl7XHJcbiAgICAgICAgICAgIGNvdW50UXVlc3Rpb25zU3VjY2VzcyA9IGNvdW50UXVlc3Rpb25zU3VjY2VzcyArMTtcclxuICAgICAgICAgICAgbWFuYWdlclF1aXoudXBkYXRlUXVlc3Rpb25zKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBtYW5hZ2VyRG9tLnJlbmRlclF1ZXN0aW9uQW5zd2VyZWQoYW5zd2VyLGlzQ29ycmVjdCk7XHJcbiAgICAgICAgbWFuYWdlckRvbS50b2dnbGVCdXR0b25OZXh0KCk7XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMubmV4dFF1ZXN0aW9uID0gZnVuY3Rpb24oKXtcclxuICAgICAgICBpZihpc1BsYXllcldpbigpKXtcclxuICAgICAgICAgICAgbWFuYWdlckRvbS5wcmludFZpY3RvcnkoKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgbGV0IHF1ZXN0aW9uID0gbWFuYWdlclF1aXouZ2V0Q3VycmVudFF1ZXN0aW9uKCk7XHJcbiAgICAgICAgICAgIG1hbmFnZXJEb20ucmVuZGVyUXVlc3Rpb24ocXVlc3Rpb24pO1xyXG4gICAgICAgICAgICBtYW5hZ2VyRG9tLnRvZ2dsZUJ1dHRvbk5leHQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfTtcclxuXHJcbiAgICBmdW5jdGlvbiBpc1BsYXllcldpbigpe1xyXG4gICAgICAgIHJldHVybiAoY291bnRRdWVzdGlvbnNTdWNjZXNzID09PSBOVU1CRVJfRk9SX1dJTik7XHJcbiAgICB9O1xyXG5cclxufTtcclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL01hbmFnZXJHYW1lLmpzIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBNYW5hZ2VyUXVpeihMaXN0UXVlc3Rpb24pIHtcclxuXHJcbiAgICBsZXQgbGlzdFF1ZXN0aW9uID0gTGlzdFF1ZXN0aW9uO1xyXG4gICAgbGV0IGN1cnJlbnRRdWVzdGlvbiA9IHJhbmRvbVF1ZXN0aW9uKCk7XHJcblxyXG5cclxuICAgIHRoaXMuZ2V0Q3VycmVudFF1ZXN0aW9uID0gKCkgPT4gKGN1cnJlbnRRdWVzdGlvbik7XHJcblxyXG4gICAgdGhpcy5nZXRMaXN0UXVlc3Rpb24gPSAoKSA9PiAobGlzdFF1ZXN0aW9uKTtcclxuXHJcblxyXG4gICAgIHRoaXMuaXNDb3JyZWN0UXVlc3Rpb24gPSBmdW5jdGlvbihhbnN3ZXIpIHtcclxuICAgICAgICBsZXQgcmVzdWx0ID0gY3VycmVudFF1ZXN0aW9uLnJlc3B1ZXN0YSA9PT0gYW5zd2VyO1xyXG4gICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLnVwZGF0ZVF1ZXN0aW9ucyA9ICBmdW5jdGlvbigpIHtcclxuICAgICAgICBkZWxldGVDdXJyZW50UXVlc3Rpb25Ub0xpc3QoKTtcclxuICAgICAgICBjdXJyZW50UXVlc3Rpb24gPSByYW5kb21RdWVzdGlvbigpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHJhbmRvbVF1ZXN0aW9uKCkge1xyXG4gICAgICAgIGxldCBpbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChsaXN0UXVlc3Rpb24ubGVuZ3RoIC0gMCkgKyAwKTtcclxuICAgICAgICByZXR1cm4gbGlzdFF1ZXN0aW9uW2luZGV4XTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBkZWxldGVDdXJyZW50UXVlc3Rpb25Ub0xpc3QoKXtcclxuICAgICAgICBsZXQgcG9zaXRpb24gPSBsaXN0UXVlc3Rpb24uaW5kZXhPZihjdXJyZW50UXVlc3Rpb24pO1xyXG4gICAgICAgIGxpc3RRdWVzdGlvbi5zcGxpY2UocG9zaXRpb24sMSk7XHJcbiAgICB9XHJcblxyXG59O1xyXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvTWFuYWdlclF1aXouanMiXSwic291cmNlUm9vdCI6IiJ9